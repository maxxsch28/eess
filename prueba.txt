 SELECT libro, concasie.sucursal, asiento, left(dbo.concasie.detalle,30), dbo.concasie.idtranglob, dbo.detaosvt.comprobant, dbo.detaosvt.sucursal, dbo.detaosvt.numero, p.codigo, p.detalle, dbo.detaosvt.precio_vta, monto, dbo.detaosvt.importe, dbo.detaosvt.iva, dbo.detaosvt.ingbruto, aliporiva, neto_grava, neto_nogra, total_item, percepib, dbo.clientes.nombre as clienteNombre, p.cuentacont, dbo.clientes.codigo as clienteCodigo, fecha_asie, dbo.detaosvt.cantidad, producto FROM dbo.concasie, dbo.detaosvt, [SqlCoop_DBSHARED].dbo.PRODUCTO p, dbo.histvtam, dbo.clientes WHERE DBO.histvtam.idtranglob=dbo.concasie.idtranglob and dbo.histvtam.cliente=dbo.clientes.codigo AND datepart(year, dbo.concasie.fecha_asie)='2017' AND datepart(month, dbo.concasie.fecha_asie)='01' AND dbo.detaosvt.producto=p.codigo AND dbo.concasie.idtranglob=dbo.detaosvt.idtranglob UNION SELECT libro, concasie.sucursal, asiento, left(dbo.concasie.detalle,30), dbo.concasie.idtranglob, dbo.detavtas.comprobant, dbo.detavtas.sucursal, dbo.detavtas.numero, p.codigo, p.detalle, dbo.detavtas.precio_vta, monto, dbo.detavtas.importe, dbo.detavtas.iva, dbo.detavtas.ingbruto, aliporiva, neto_grava, neto_nogra, total_item, percepib, dbo.clientes.nombre as clienteNombre, p.cuentacont, dbo.clientes.codigo as clienteCodigo, fecha_asie, dbo.detavtas.cantidad, producto FROM dbo.concasie, dbo.detavtas, [SqlCoop_DBSHARED].dbo.PRODUCTO p, dbo.histvtam, dbo.clientes WHERE DBO.histvtam.idtranglob=dbo.concasie.idtranglob and dbo.histvtam.cliente=dbo.clientes.codigo AND datepart(year, dbo.concasie.fecha_asie)='2017' AND datepart(month, dbo.concasie.fecha_asie)='01' AND dbo.detavtas.producto=p.codigo AND dbo.concasie.idtranglob=dbo.detavtas.idtranglob ORDER BY producto;
 